# 项目说明：无人机项目Monorepo（FastAPI+静态页）

## 1. 项目定位
这是一个用于“联通验证/最小闭环演示”的 Monorepo：
- 后端：FastAPI（健康检查、简易规划占位、WebSocket）
- 前端：无需构建的静态页面（Mapbox + WS）
- 运维：Docker Compose 启动 EMQX 与后端（开发用途）
- 机载（onboard）：ROS2 相关模块占位，便于后续迁移
- 视频（video）：ffmpeg UDP 推流示例

## 2. 当前状态
- 重点在于“最小可运行样例”，很多模块为占位或示例。
- 适合用于验证：前端 → WS → 后端 的基本通信与规划消息格式。

## 3. 目录结构速览（关键内容）
- `backend/`：FastAPI 服务（含 unittest）。
- `frontend/`：静态网页（打开 index.html 即可）。
- `ops/`：docker compose（EMQX + 后端）。
- `rc_host/`：协议相关 Python 代码与测试。
- `onboard/`：ROS2 模块占位。
- `video/`：ffmpeg 推流示例。

## 4. 快速运行（Windows）
### 4.1 启动后端
- `cd backend`
- `python -m venv .venv`
- `./.venv/Scripts/Activate.ps1`
- `pip install -r requirements.txt`
- `uvicorn main:app --reload --host 0.0.0.0 --port 8000`
- 打开 `http://localhost:8000/health`

### 4.2 打开前端
- 编辑 `frontend/index.html`，把 `YOUR_MAPBOX_TOKEN` 替换为你的 token。
- 直接打开或用 Live Server 打开。
- 连接 `ws://localhost:8000/ws` 并发送 `path.update` 验证回路。

### 4.3 可选：docker compose
- `cd ops`
- `docker compose up`

## 5. 测试
- `backend`：`python -m unittest`
- `rc_host`：`python -m unittest`

## 6. 文档索引
- [README.md](README.md)：Monorepo 模块概览。
- [README-RUN.md](README-RUN.md)：开发首跑的操作步骤。
- [backend/README.md](backend/README.md)：后端接口与启动方式。
- [frontend/README.md](frontend/README.md)：前端使用方式。
- [ops/README.md](ops/README.md)：compose 启动说明。
- [onboard/README.md](onboard/README.md)：ROS2 占位说明。
- [video/README.md](video/README.md)：推流示例说明。

## 7. 演进线索（便于回忆）
- 这是一个“把端到端通信先跑通”的工程化骨架，用占位实现把接口/链路固定下来。

## 8. 已知问题与待改进
- onboard 为占位，缺少完整 ROS2 包 manifest（package.xml/setup.py）。
- video 为示例命令，需按平台替换硬件编码器。
